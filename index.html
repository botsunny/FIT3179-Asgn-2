<!DOCTYPE html>
<html>
<head>
  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.22.1"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.5.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.21.0"></script>
  
  <!-- Import pure.css -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
  integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- CSS file -->
  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
</head>

<body>
  <h1>15th MALAYSIAN GENERAL ELECTION</h1>
  <p id="intro">
    The 15th Malaysian General Election (GE15) was held on 19 November 2022.
    It was a rather unique one; a snap election held to resolve political
    instability that resulted in the first hung parliament in Malaysian history.
  </p>

  <p id="paragraph-text">
    The following map shows the final results of GE15. Note that the
    <span style="color: #ed1c24;"><b>Democratic Action Party (DAP)</b></span>
    is a member of the <span style="color: #d7282f;">Pakatan Harapan (PH)</span>
    coalition, but contests under its own name and logo in the state of <b>Sarawak</b>.
    Similarly, <span style="color: #009000;"><b>Parti Islam Se-Malaysia (PAS)</b></span>
    is a member of the <span style="color: #003152;">Perikatan Nasional (PN)</span>
    coalition, but all <span style="color: #003152;">PN</span> parties
    contest under <span style="color: #009000;">PAS</span>'s name and logo in
    the states of <b>Kelantan and Terengganu</b>.
    <br><br>
    In any election, understanding the demographics of the electorate as well as
    the turnout during election day are keys to interpreting the results.
    <br><br>
    Use the buttons to switch between maps for demographics and turnout!
    (<u>Note</u>: Turnout data ranges from <b>40% to 100%</b>; turnout data for
    <b>P.017 Padang Serai</b> was not provided by the Election Commission.)
  </p>

  <div id="map" class="map-container"></div>
  <br>
  <button id="change-win-map">Results</button>
  <button id="change-demog-map">Demographics</button>
  <button id="change-turnout-map">Turnout</button>

  <!-- pure grid group -->
  <div class="pure-g">
    <div class="pure-u-1-2">
      <p id="top-padded-left-column-text">
        In recent years, Malaysia has seen a shift from a single-coalition dominance
        (<span style="color: #000080;">Barisan Nasional</span>) to a two-coalition
        battle, and in GE15, a three-cornered fight. High-income, densely populated
        urban constituencies tend to prefer <span style="color:#d7282f;">PH</span>
        whereas the opposite has strong support for <span style="color: #003152;">PN</span>.
        <br><br>
        Use the radar charts to discover the <b>economic</b> and <b>social</b>
        factors of each constituency!
      </p>
      <div class="pure-g">
        <div class="pure-u-2-3">
          <div id="radar" class="vis-container"></div>
          <button id="change-econ-radar">Economic factors</button>
          <button id="change-social-radar">Social factors</button>
        </div>
        <div class="pure-u-1-3">
          <p id="inner-column-text">
            Unemployment rate: <b>Estimated based on 2020 Labour Force Survey data</b>
            <br><br>
            Poverty incidence: <b>Poverty is defined as household income below the 2019 Poverty Line</b>
            <br><br>
            Median income: <b>Normalised median household income, estimated based on the 2020 Household Income, Expenditure and Basic Amenities (HIES/BA) Survey</b>
            <br><br>
            Average expenditure: <b>Normalised average household expenditure</b>
            <br><br>
            Gini coefficient: <b>Measures income inequality (0% is perfect equality, 100% is perfect inequality)</b>
            <br><br>
            Population density: <b>Normalised population density</b>
            <br><br>
            Average household size: <b>Normalised average of household sizes</b>
          </p>
        </div>
      </div>
    </div>
    <div class="pure-u-1-2">
      <p id="top-padded-right-column-text">
        GE15 is the first election since the nation's voting age was lowered to
        18. The following pyramid chart shows the age distribution of the
        electorate based on gender. For both genders, millenials and working adults
        aged <b>21-39</b> make up the majority of voters.
        <br><br><br>
      </p>
      <div id="pyramid" class="vis-container"></div>
    </div>
  </div>
  <!-- end pure grid group -->

  <!-- pure grid group -->
  <div class="pure-g">
    <div class="pure-u-1-2">
      <p id="left-column-text">
        This general election saw 23 coalitions and parties contesting for the
        222 federal seats of the Dewan Rakyat. To win a seat, a candidate only
        needs to obtain at least a plurality (ie. largest share) of votes in the
        corresponding constituency.
        <br><br>
        These boxplots show the popular vote percentages obtained by each
        coalition/party over their contested seats. <b>Some parties have been
        excluded</b> due to low numbers that render them invisible in the plot.
        These are: <span style="color: #f5d801";>Parti Bersatu Rakyat Sabah</span>,
        <span style="color: #fbc625";>Parti Bumi Kenyalang</span>,
        <span style="color: #ffcd00";>Parti Perpaduan Rakyat Sabah</span>,
        <span style="color: #e0d500";>Parti Sedar Rakyat Sarawak</span>,
        <span style="color: #800000";>Parti Sosialis Malaysia</span> and
        <span style="color: #ffa500";>Parti Utama Rakyat</span>.
        <br><br>
      </p>
      <div id="boxplot" class="vis-container"></div>
    </div>
    <div class="pure-u-1-2">
      <p id="right-column-text">
        GE15 centers around a three-way fight between the <span style="color: #000080">BN</span>,
        <span style="color: #d7282f">PH</span> and
        <span style="color: #003152">PN</span> coalitions. Comparing their
        changes in seats from the previous election illustrates how public
        sentiment towards each has shifted over the previous four years of
        political turmoil.
        <br><br>
        Note that <span style="color: #003152">PN</span> did not exist in GE14;
        its two major component parties, <span style="color: #009000">PAS</span>
        and <span style="color: #e62020">Parti Pribumi Bersatu Malaysia (BERSATU)</span>,
        contested on its own and under <span style="color: #d7282f">PH</span>
        respectively. In this comet chart, <span style="color: #d7282f">PH</span>'s
        GE14 numbers include <span style="color: #e62020">BERSATU</span>'s
        seats, and <span style="color: #003152">PN</span>'s GE14 numbers are
        represented by <span style="color: #009000">PAS</span>'s seats.
        <br><br>
        Filter the chart by coalition and state to observe the degrees of gains
        and losses of the coalitions.
      </p>
      <div id="comet" class="vis-container"></div>
    </div>
  </div>
  <!-- end pure grid group -->

  <!-- pure grid group -->
  <div class="pure-g">
    <div class="pure-u-1-1">
      <p id="pure-paragraph-text">
        Malaysia is a multi-ethnic country, with <span style="color: #54a24b">Bumiputera</span>,
        <span style="color: #e45756">Chinese</span> and <span style="color: #f58518">Indians</span>
        making up around 70, 23 and 7% of the population respectively. Additionally,
        politics in the nation has always been dominated by men, although female
        representation in the Dewan Rakyat has been increasing steadily with every
        election prior to GE15.
        <br><br>
        Now let us take a look at how the nominated candidates in this election
        reflect the ethnic and gender composition of the country, and see how
        each party/coalition contributes to diversity.
      </p>
      <div id="bar1" class="vis-container"></div>
    </div>
    <div class="pure-u-1-1">
      <p id="pure-paragraph-text">
        Ethnic proportions among candidates fielded by major coalitions seem to
        reflect the nation's demographics well, but what about the actual politicians
        ending up in the Dewan Rakyat?
        <br><br>
        Despite GE15 resulting in a unity government led by <span style="color: #d7282f">PH</span>,
        which fielded the most female candidates, female MPs were actually reduced
        to 30 from 32 in GE14.
        <br><br>
        Here is how the final representation of ethnicities and genders in the
        Dewan Rakyat looks like after GE15; we can also observe which parties/coalitions
        are popular preferences among the different ethnic communities.
      <div id="bar2" class="vis-container"></div>
    </div>
  </div>
  <!-- end pure grid group -->

  <!-- Footer section -->
  <footer>
    <p id="footer">
      &copy; 2023 Visualisation by Yu-Shan Lim 
      <br>
      Data collected from the Election Commission of Malaysia (SPR)
      <br>
      by <a href="https://github.com/Thevesh/analysis-election-msia">Thevesh Theva</a> (2022)
    </p>
  </footer> 

<script type="text/javascript">
  var spec1 = "js/map_win.vg.json";
  var spec2 = "js/map_demog.vg.json";
  var spec3 = "js/map_turnout.vg.json";
  var spec4 = "js/radar1.vg.json";
  var spec5 = "js/radar2.vg.json";
  var spec6 = "js/pyramid.vg.json";
  var spec7 = "js/boxplot.vg.json";
  var spec8 = "js/comet.vg.json";
  var spec9 = "js/stacked_bar1.vg.json";
  var spec10 = "js/stacked_bar2.vg.json";

  let currentMap = null; // To keep track of the current map

  // Function to embed the selected map
  function embedMap(spec) {
    if (currentMap !== spec) {
        vegaEmbed("#map", spec).then(() => {
          currentMap = spec;
        }).catch(console.error);
    }
  }

  embedMap(spec1);

  const button1 = document.getElementById("change-win-map");
  const button2 = document.getElementById("change-demog-map");
  const button3 = document.getElementById("change-turnout-map");

  button1.addEventListener("click", () => {
    embedMap(spec1);
  });
  button2.addEventListener("click", () => {
    embedMap(spec2);
  });
  button3.addEventListener("click", () => {
    embedMap(spec3);
  });

  let currentRadar = null;

  // Function to embed the selected radar chart
  function embedRadar(spec) {
    if (currentRadar !== spec) {
      vegaEmbed("#radar", spec).then(() => {
        currentRadar = spec;
      }).catch(console.error);
    }
  }

  embedRadar(spec5)

  const button4 = document.getElementById("change-social-radar");
  const button5 = document.getElementById("change-econ-radar");

  button4.addEventListener("click", () => {
    embedRadar(spec4);
  });
  button5.addEventListener("click", () => {
    embedRadar(spec5);
  });

  vegaEmbed('#pyramid', spec6, { "actions": false }).then(function (result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);

  vegaEmbed('#boxplot', spec7, { "actions": false }).then(function (result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);

  vegaEmbed('#comet', spec8, { "actions": false }).then(function (result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);

  vegaEmbed('#bar1', spec9, { "actions": false }).then(function (result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);

  vegaEmbed('#bar2', spec10, { "actions": false }).then(function (result) {
    // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
  }).catch(console.error);

</script>
</body>

</html>
